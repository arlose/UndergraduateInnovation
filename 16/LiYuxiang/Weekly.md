# 2019

------

## W26 06.24-06.30

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、总结上周学习Flask的笔记和项目中遇到的问题及经验。 |
|  2、在树莓派上运行改良后的代码。 |
|   |

| 遇到的问题 |
| :--------- |
|   |
|   |
|   |
|   |

| 下周计划                           |
| :--------------------------------- |
|  下周有时间的话看看能不能提高人脸数据的训练效果。 |
|                                    |
|                                    |

- 其他

笔记、总结经验在周报的最后面。

------

## W25 06.17-06.23

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、学习千锋的Web开发之Flask框架从入门到精通，主要是针对项目设计方面学习，之前我对Flask还不太熟悉，就导|
|   致前面进度比较慢，并整理笔记以便以后能快速掌握。|
|  2、梳理之前写的代码，把它们按照别人项目的分类方法，将之前的主程序(app.py)分为用户视图(user.views.py)、|
|   相机视图(camr.views.py)以及命令模式主程序(manage.py)，加了个文件(Face_Data.txt)来记录人脸id和name，|
|    并直接读取来实现人脸数据采集和识别的功能，将一些其他文件分类放入文件夹中，便于管理。|
|  3、学习Flask-Boostrap插件还有一些其他的插件，将界面进行了美化。|

| 遇到的问题 |
| :--------- |
|  1、如果直接将那些视图函数和运行程序分开，并相互引用的话会出现循环引用的问题，程序就会崩溃，解决方法就是|
|   在view文件里定义个蓝图，然后在app文件里注册蓝图在运行即可。|
|  2、在Pycharm写html文件，用jinja2的继承模板函数不高亮，解决办法就是讲templates文件夹右键点击标记为html|
|   文件夹并选择jinja2语言即可。|

| 下周计划                           |
| :--------------------------------- |
|  笔记我会下周整理出来，遇到的问题也有点多（上面简写），之后会写个详细的总结报告。 |
|                                    |
|                                    |

- 其他

改良的程序文件只是在windows环境下运行了，在树莓派上面还出现了问题，下周解决。

------

## W24 06.10-06.16

| 本周工作                                                     |
| :----------------------------------------------------------- |
|   |
|   |
|   |

| 遇到的问题 |
| :--------- |
|   |
|   |
|   |
|   |

| 下周计划                           |
| :--------------------------------- |
|  下周抓紧时间对剩余部分做完。 |
|                                    |
|                                    |

- 其他

这几天的时间主要花费在了音视频处理和数字图像处理的大作业。

------

## W23 06.03-06.09

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、人脸识别时候读取txt文件中的name数据。|
|   |
|   |

| 遇到的问题 |
| :--------- |
|  1、之前想在路由视图函数里用os.open.path((filename).read())方法打开，第一行的"id"和"name"也读入了， |
|  使用csv的reader方法，读取到第一行的数据，然后用next()，跳入第二行数据进行读取，读取name数据放到names |
|  的列表里就可以了。 |
|   |

| 下周计划                           |
| :--------------------------------- |
|  下周实现name和id写入txt文件。 |
|                                    |
|                                    |

- 其他

主要最近在复习信息论考试和大作业，时间花得比较少。

------

## W22 05.27-06.02

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、人脸识别能在网页上实现。|
|  2、人脸数据采集能获取并保存，姓名和id号需要在程序内改。 |
|   |

| 遇到的问题 |
| :--------- |
|  1、在获取视频流的时候直接使用cv2.VideoCapture(0)，会导致摄像头打不开的问题，网上说需要重新定义一下， |
|  class MyVideoCapture(cv.VideoCapture): def __enter__(self): return self def __exit__(self, *args):  self.release()。 |
|  2、之前数据采集不到，是因为我之前视频流好像没获取到，只是在cv2.imshow中显示，难怪一直没有数据，改了下 |
|  之前的代码，然后再加一个循环终止条件用来关闭摄像头就好了。 |

| 下周计划                           |
| :--------------------------------- |
|  下周我想能不能创建一个文件，把人脸的姓名和id号存入，这样就不用在程序内改id和姓名了，界面美化一下。 |
|                                    |
|                                    |

- 其他

------

## W21 05.20-05.26

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、在win10环境下安装树莓派的opencv版本。|
|  2、结合Flask的py文件运行。|
|   |

| 遇到的问题 |
| :--------- |
|  1、树莓派版本是opencv-python-3.3.0+contrib，win10环境下此版本没有下载资源，找了个接近的3.4.6，还存  |
|  在读取yml文件出现问题，又安装了3.4.4.19，2.4.13.7，还是没用，最后试着重新训练编译一个新的yml文件就好 |
|  了。|
|  2、结合Flask的时候，主要还是网址找不到的问题，主要是在主机号和端口上没设置好导致出错，主机号默认，端口 |
|  随便设置一个就行。 |

| 下周计划                           |
| :--------------------------------- |
|  下周针对我之前在树莓派上面出现的错误进行解决。 |
|                                    |
|                                    |

- 其他

------

## W20 05.13-05.19

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  1、这周主要是在windows环境下运行我之前在树莓派上面写的代码，先是git到我的github项目里，然后下载到电脑上 |
|  运行时主要因为环境等问题出现了很多问题。 |
|  |

| 遇到的问题 |
| :--------- |
|  1、PiCamera包在windows环境下不能使用，直接调用摄像头就好了。 |
|  2、cv2库中找不到faces.py，经上网查找得知问题出在opencv_contrib_python没装好，重装了好几次（每次都提示 |
|     安装成功，具体原因不明）才能在cv2中找到LBP的人脸识别器的创建函数。 |

| 下周计划                           |
| :--------------------------------- |
|  下周主要是试一下结合flask运行。 |
|                                    |
|                                    |

- 其他

------

## W18 04.29-05.05

| 本周工作                                                     |
| :----------------------------------------------------------- |
|  |
|   |
|  |

| 遇到的问题 |
| :--------- |
|  |
|      |
|            |

| 下周计划                           |
| :--------------------------------- |
|  |
|                                    |
|                                    |

- 其他

五一放假，所以这周没干什么事，下周补上。

------

## W17 04.22-04.28

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、主要对手写数字识别的代码进行了改进，训练出的识别率有所提升。 |
| 2、搜了那本深度学习（花书） 的pdf资源来看。  |
|  |

| 遇到的问题 |
| :--------- |
|  |
|      |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周学习一下深度学习（花书），解决人脸识别剩下的部分。 |
|                                    |
|                                    |

- 其他

------


## W16 04.15-04.21

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、学着用python语言对手写数字识别写了一层卷积、池化、激活的简单神经网络，感觉效果不太好。 |
| 2、树莓派人脸识别数据存储问题还未解决。  |
|  |

| 遇到的问题 |
| :--------- |
|  |
|      |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周主要还是解决我那个人脸识别问题，查找下网上手写数字识别的代码学习一下。 |
|                                    |
|                                    |

- 其他

------


## W15 04.08-04.14

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、通过网上的方法解决我的人脸数据采集问题，还是不行。 |
|  |
|   |

| 遇到的问题 |
| :--------- |
|  |
|      |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周主要还是对上面的问题进行解决。 |
|                                    |
|                                    |

- 其他

------


## W14 04.01-04.07

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、将获取的人脸数据储存在树莓派文件库中。 |
| 2、学习了vs-code+cmake 利用它们运行一些大型c项目，https://github.com/kigster/cmake-project-template 运行的是这个项目文件。 |
|                                                              |

| 遇到的问题 |
| :--------- |
|  1、人脸数据储存在树莓派文件库出现错误，暂时还没有解决办法。 |
|  2、cmake完了后，main.cpp里面还出现很多未定义的变量，主要是cmakelists.txt的include和lib路径配置不对。     |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周主要是对这次出现的人脸数据储存问题进行解决。 |
|                                    |
|                                    |

- 其他

------


## W13 03.25-03.31

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、本周主要解决了上周的摄像头全屏的问题，并修改了一下人脸识别的代码，让画面能够显示人脸识别框。 |
| 2、然后在前面的扑克牌项目中运行了一下，写了个快速排序的代码部分。 |
|                                                              |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周修改获取人脸数据的部分。 |
|                                    |
|                                    |

- 其他

------


## W12 03.18-03.24

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、本周主要对上周的camera_pi.py视频流文件进行改良，看是否能显示识别框，但是出现了全屏操作不了的问题。 |
|                                                              |
|                                                              |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                           |
| :--------------------------------- |
| 下周主要解决摄像头全屏显示的问题。 |
|                                    |
|                                    |

- 其他

------


## W11 03.11-03.17

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、本周主要结合上次的视频流代码改写了人脸识别文件的代码，运行时能够进行对摄像头图像人脸进行判断， |
| 但是由于我是将cv2和picamera结合使用，使用的时候将use_video_port图像端口设为True，画面上 |
| 显示不出原来的人脸识别框，在后台还是能看到人脸识别的结果。 |

| 遇到的问题 |
| :----------------------------------------------------------- |
| 1、运行时出现"attributeerror:'modoule' object has no attribute 'CV_LOAD_IMAGE_UNCHANGED'" |
| 只需改成"IMREAD_UNCHANGED",出错原因可能跟python版本有关。 |
| 2、变量id出现unboundlocalerror问题，原因是在用foo函数的时候，定义的全局变量id在其内部视为局部变量， |
| 并且被视为未定义变量，将定义的id变量加入foo函数中就可以了。 |

| 下周计划                             |
| :-------------------------------------------------- |
| 下周主要将后台人脸识别的结果显示在网页上，并且实现对人脸数据的采集。 |
|                                      |
|                                      |

- 其他

------
## W10 03.04-03.10

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、本周主要对上周出现树莓派摄像画面全屏显示的界面问题进行解决，主要参考了别人的树莓派视频流的代 |
| 码，https://github.com/CriseLYJ/flask-video-streaming-recorder 。 |
| 2、查阅和了解了html的资料，http://www.w3school.com.cn/tags/html_ref_language_codes.asp 。 |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                             |
| :----------------------------------- |
| 下周尝试能否结合之前的人脸识别代码。 |
|                                      |
|                                      |

- 其他

------


## W09 02.25-03.03

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、寒假主要是在网页框架上解决了如何获取树莓派摄像头画面的问题，还有复习英语考研。 |
| 2、本周对树莓派上出现的视频流问题进行解决。                  |
|                                                              |

| 遇到的问题                                                   |
| :----------------------------------------------------------- |
| 1、app.py运行出现socket（error:10013）问题，主要是因为端口被占用，将port值改一下就可以。 |
| 2、出现PiCameMMALError:Failed to enable connection : Out of resources( other than memory)问题，主 |
| 要是因为摄像头正在另一进程使用，将程序终止后就可以。         |
| 3、出现摄像头画面全屏显示在界面上且无法进行任何操做的问题，还没找到解决的办法。 |

| 下周计划                         |
| :------------------------------- |
| 下周开始完成树莓派的未完成部分。 |
|                                  |
|                                  |

- 其他

------



## W04 01.21-01.27

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、在TensorFlow实训中，我向培训老师要了两本关于Flask的电子书，一本是Miguel Grinberg的《基于 |
| Python的Web应用开发实践》，还有一本是刘长龙的《Python高效开发实战》。 |
| 2、然后是我写好了摄像头方面的代码，准备改进一下对实时人脸信息进行处理。 |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                         |
| :------------------------------- |
| 下周开始完成树莓派的未完成部分。 |
|                                  |
|                                  |

- 其他

------

上周的周报我已经成功上交了，但是后面怎么又没有上传成功。

## W03 01.14-01.20

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 本周参加TensorFlow实训，主要学习了对数据的处理分析，具体体现于简单神经网络的实现。 |
|                                                              |
|                                                              |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                         |
| :------------------------------- |
| 下周开始完成树莓派的未完成部分。 |
|                                  |
|                                  |

- 其他

------



## W02 01.07-01.13

| 本周工作                                               |
| :----------------------------------------------------- |
| 本周主要是预习实训内容，对一些数据处理有更深入的了解。 |
|                                                        |
|                                                        |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                                         |
| :----------------------------------------------- |
| 下周参加TensorFlow实训课程（5天），回家（1天）。 |
|                                                  |
|                                                  |

- 其他

------

这周的周报我本来提交了的，但是好像被别人替换了一下，所以没有及时上交。
## W01 12.31-01.06

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 本周主要是复习数字信号处理，准备考试；然后继续解决我上周未完成的问题，其中我看了网上flask的基本教 |
| 程，弄清了flask中路由参数，但都是和数据库有关的，帮助有限。  |
|                                                              |

| 遇到的问题                                                   |
| :----------------------------------------------------------- |
| 1、起初收集人脸数据的py中需要输入id，即为人脸编号，运行的时候就会一直在这里等待，无法进行下一步 |
| 所以我想通过传参数进去，首先在页面上定义了text文本框，然后获取再运行项目py文件，但是不行，所以我 |
| 下周准备将py文件的所有代码都放在视图函数下运行一下。         |
| 2、然后是直接运行其他py文件时，会出现不存在models的错误，问题尚未解决，还在寻找解决办法。 |

| 下周计划                             |
| :----------------------------------- |
| 下周考试之后，尽力将出现的问题解决。 |
|                                      |
|                                      |

- 其他

------



# 2018

## W52 12.24-12.30

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 1、学习flask网络应用架构的搭建以及相关代码，基本了解了代码含义和构建的方法。 |
| 2、在我原来的项目里继续编写了app.py文件（主要运行），完善了路由和对应调用的函数，主要根据前面我 |
| 实现的功能写了获取人脸数据和人脸识别两个，但是在调用我之前写的py项目文件上出现了问题。 |
| 3、然后对主界面、获取人脸数据界面、人脸识别界面分别建立了对应的html文件，用到也都是基本页面设计 |
| （主要是button的运用），页面功能基本实现；还有一个style.css文件（用来定义页面风格）。 |

| 遇到的问题                                                   |
| :----------------------------------------------------------- |
| 1、起初我想把所有项目文件都放在一个文件夹里面，但是app.py运行出现找不到对应的html文件，解决办法 |
| 就是把它们放在templates文件夹下面就可以了。                  |
| 2、原本是想在页面上的button反应后找到app.py文件里定义好的路由，再通过对应的函数运行我之前的项目 |
| 文件，但是不行，还未找到合适的办法，会解决的。               |

| 下周计划                                                     |
| :----------------------------------------------------------- |
| 继续解决出现的问题和完成未完成的部分工作，争取下周在实现方面上基本完成。 |
|                                                              |
|                                                              |

- 其他

------



## W51 12.17-12.23

| 本周工作                                                     |
| :----------------------------------------------------------- |
| 本周主要完成我的算法导论大作业和移动应用开发大作业，时间有点紧，树莓派暂时没有进展。 |
|                                                              |
|                                                              |

| 遇到的问题 |
| :--------- |
|            |
|            |
|            |

| 下周计划                                          |
| :------------------------------------------------ |
| 下周课程基本结束，将直接将树莓派的Flask搭建起来。 |
|                                                   |
|                                                   |

- 其他

------



## W50 12.16-12.22

| 本周工作 |
| :-: |
| w1   |
| w2   |
| w3   |

| 遇到的问题 |
| :-: |
| q1   |
| q2   |
| q3   |

| 下周计划 |
| :-: |
| q1   |
| q2   |
| q3   |

* 其他

# Flask学习笔记

#### Falsk

* 基于Python的**微**框架

* **微**：尽量保持代码核心的简洁，不为开发者做过多的选择，给开发者更多的一个选择空间

#### MVC/MTV

* 一个软件架构设计思想

* 解耦合

* 将页面展示、数据操作、逻辑处理进行拆分

* Models：模型

* Templates：模板

* Views：视图

#### HelloFlask

* 安装 pip install flask

  * jinja2

  * werkzukg wsgi工具集

  * ```
  form flask import Flask
    app = Flask(__name__)
    
    @app.route('/')
    def index()；
    	return 'Hello Flask'
    ```

* 书写项目

  * ```
    app.run()
    ```

* 请求流程

  * 浏览器——路由器（route）
  * 路由器——视图函数（views）
  * 视图函数——模型（modules）
  * 模型——视图函数
  * 视图函数——模板（templates）
  * 模板——浏览器

* Views：

  * 路由器
    * 参数
      * 路径参数中的关键字参数
      * <var>默认类型都会被认为是string
      * 语法：<converter:var>
        * converter：转换器，格式约束工具
        * string：不把  **'/'**  作为参数的一部分
        * int：约束为int类型
        * float：约束为float类型
        * path：把  **'/'**  作为参数的一部分
        * uuid：校验uuid格式
        * any：提供元祖元素当中中的任意元素

  * 视图参数

    * 路径参数
      * 在host:port之后，在？之前的部分
      * 位置参数
      * 关键字参数

    * 请求参数
      * ？之后的部分，get请求参数
      * post请求参数在请求体中

  * Request
    * 请求
    * Flask根据Http报文创建的请求对象
    * methods：请求方法
    * url：
    * path：
    * host：
    * cookie：
    * args：GET里面的参数
      * 类字典结构
      * 每一项都是一个元祖
      * 元祖包括两个子元素，左侧是key，右侧是value
      * key是可重复的
      * ImmutableMultiDict
      * dict['name']
      * dict.get('name')
      * dict.getlist('name')
    * form：POST提交的参数
    * files：文件上传参数
    * remote_addr：远端IP地址
    * user-agent：浏览器访问标志
  
  * Response
    * 字符串（content，status）
    * render_template
    * make_response
    * Response
    * 响应类型
      * Response对象
      * redirect
      * about
      * json
        * jsonify进行包装
  
  * 会话技术
  
    * 出现场景：后续的请求需要前面请求返回的数据
    * 原因
      * web开发中，使用的http基本都是短连接
      * 生命周期非常短，从Request开始到Response结束
  
    * 实现机制：让客户知道自己是谁
  
    * cookie
  
      * 客户端会话技术
  
      * 数据存储在客户端中，浏览器中
  
      * 特性
  
        * 存储结构：key-value
        * 支持过期时间
          * max-age
          * expires
  
        * 不能跨域名
        * 不能跨浏览器
        * 默认会携带本网站的所有cookies
        * 默认明文传输
        * 默认不支持中文
  
      * flask中的cookie可以直接使用中文：对不支持的语言进行了解码
      * cookie支持中文
        * 使用编码解码
        * 使用加密解密
  
    * session
  
      * 服务器会话技术
      * 数据存储在服务器
      * 特性
        * 依赖cookie
        * 支持过期
        * key-value存储结构
  
      * session在flask默认没有实现持久化
      * 实现持久化
        * 插件：flask-session
  
    * token
      * 服务端会话技术
      * 手动实现的session
      * 如果用来web中和session基本一致
      * 在专用客户端中，不支持cookie
      * 需要客户端自己维护token

* Templates

  * 主要是帮助开发者生成用户查看的页面

  * 组成结构

    * 静态html

    * 动态模板语法

      * {{ var }}

      * {{ tag }}

        * 结构标签

          * block
            * 默认填坑会覆盖所有内容
            * 不想覆盖{{ super() }}

          * entends
          * include
          * macro
            * 宏定义
            * 定义函数
            * 提高代码复用率
            * 函数主要生成了结构的html
            * 亮点{% from xxx import xxx %}
            * 通常会有专门的文件存放宏定义

  * 过滤器
    * {{ var|过滤器|过滤器 }}
    * 过滤器可以写多个，但执行顺序不一定从前向后
    * 本质上是函数
    * 允许接收参数

  * 加载过程
    * 先加载
    * 后渲染

  * 插件：flask-bootstrap
  * flash
    * 消息闪现
      * 在Python中：flash ('message')
      * 在templates中：get_flash_messages()
    * 自己实现
      * 使用session
      * 需要维护所有资源

* Model
  * 模型
  * 



#### 插件

* Flask-script

  * 在终端动态接受命令行参数，传递到Python代码中
  * 使用流程
    * pip install flask-script
    * 初始化
      * 使用app对象构建manager
      * 启动的时候，使用manager去run

  * 具体使用
    * shell：加载一个flask环境的终端
    * runserver
      * 启动服务器
      * -r：加载
      * -d：Debug模式
      * -p：Port，端口
      * -h：Host，主机



* flask-blueprint

  * 蓝图，蓝本
  * 对程序一个规划
  * 解决循环引用问题
  * 拆分了views，代替了用app来注册路由的问题
  * 使用流程
    * pip install flask-blueprint
    * 初始化
      * 创建蓝图对象
        * 蓝图名字唯一，见名知意
        * 导入名字

  * 使用
    * 和app注册路由基本一致
    * @blue.route()

  * url_for
    * endpoint：默认函数名字
    * 蓝图中使用：蓝图名.函数名



* flask-session
  - 安装：pip install flask-session
  - 初始化：使用app构造一个session对象
    - 配置SESSION_TYPE
    - 配置SECRET_KEY



* flask-boostrap

  * 使用流程
    * 安装：pip install flask-bootstrap
    * 使用app构造一个Bootstrap对象

  * 为开发者实现
    * 导入Bootstrap CDN
    * 创建base.html
      * 划分block
      * doc
      * html
      * head
      * body
      * title
      * metas
      * styles
      * navbar
      * content

  * 新大陆
    * IE8 兼容
    * Google 统计，分析
    * 消息渲染



#### 项目拆分

* 对项目有一个美好的规划，提升项目的一个扩展性

* 解耦合

* MTV

* 拆分流程

  * manage.py：控制管理程序
  * App：真正的应用
  * App / __ init __ ：
    * 进行全局创建，初始化
    * 创建一个Flask对象 app

  * App / settings ：在init中调用settings，进行项目整体初始化
  * App / views ：在全局初始化之后，注册蓝图，添加路由
  * App / ext ：统一管理第三方包
  * App / models：模型

````

````
-------------------------------------------------------------
